#header(10,102,"新增线路订单信息")
<script>
    function setBxyf(){
        var priceBxys=jQuery("#priceBxys").val()==''?0:jQuery("#priceBxys").val();
        jQuery("#priceBxyf").val(priceBxys);
    }
	function calculate(){
		var priceYsdj=jQuery("#priceYsdj").val()==''?0:jQuery("#priceYsdj").val();
		var priceBxys=jQuery("#priceBxys").val()==''?0:jQuery("#priceBxys").val();
        var priceBxyf=jQuery("#priceBxyf").val()==''?0:jQuery("#priceBxyf").val();
		var priceQtys=jQuery("#priceQtys").val()==''?0:jQuery("#priceQtys").val();
		var priceQtzc=jQuery("#priceQtzc").val()==''?0:jQuery("#priceQtzc").val();
		var nameListSize=jQuery("#nameListSize").val()==''?0:jQuery("#nameListSize").val();
		var productPrice=jQuery("#productPrice").val()==''?0:jQuery("#productPrice").val();
		
		var priceZjys = 0.0;
		var priceZjyf = 0.0;
		var grossProfit = 0.0;
		
		if(priceYsdj&&priceBxys&&priceBxyf&&priceQtys&&priceQtzc&&nameListSize){
			priceZjys = Math.round(parseFloat(priceYsdj*100*nameListSize+priceQtys*100+priceBxys*100))/100;
			priceZjyf = Math.round(parseFloat(productPrice*100 * nameListSize+priceQtzc*100+priceBxyf*100))/100;
			grossProfit = Math.round(parseFloat(priceZjys*100 - priceZjyf*100))/100;
		}
		
		jQuery("#priceZjys").val(priceZjys);
		jQuery("#priceZjyf").val(priceZjyf);
		jQuery("#grossProfit").val(grossProfit);
	}
	function getProductPrice(){
		var productId=jQuery("#productId").val();
		if(productId==''){
			return;
		}
		jQuery.ajax({
    	   type: "POST",
    	   url: "/product/getProductPrice.do",
    	   data:{productId:productId},
    	   success: function(result){
		   		if(result!='error'){
    				jQuery("#productPrice").val(result);
					calculate();
				}
    	   }
		});
	}
	
	function searchCustomer(){
		jQuery("#dropbox").hide();
		var customerName=jQuery("#tempCustomerName").val();
		if(customerName==''){
			return;
		}
		jQuery.ajax({
    	   type: "POST",
    	   url: "/customer/searchCustomer.do",
    	   data:{customerName:customerName},
    	   success: function(result){
		   		var searchResult=jQuery("#searchResult");
    			var customerList=result;
				if(customerList&&customerList.length>0){
    				var html='';
    				for(var i=0;i<customerList.length;i++){
    					html+='<li><a href="javascript:setProductId('+customerList[i].customerId+',\''+customerList[i].customerName+'\')">'+customerList[i].customerName+'</a></li>';
    				}
    				searchResult.empty();
    				searchResult.append(html);
    				jQuery("#dropbox").show();
				}
    	   }
		});
	}
	
	function setProductId(customerId,customerName){
		jQuery("#customerId").val(customerId);
		jQuery("#tempCustomerName").val(customerName);
		jQuery("#customerShowName").val(customerName);
		jQuery("#dropbox").hide();
	}
	
    function changeCountry(){
        var continentId = jQuery("#continentId").val();
        jQuery.ajax({
           type: "POST",
           async:false,
           url: "/country/listByContinentId.do",
           data:{continentId:continentId},
           success: function(result){
                var countryList=result;
                var options='<option value="" selected="selected">请选择</option>';
                for(var i=0;i<countryList.length;i++){
                    options+='<option value='+countryList[i].countryId+'>'+countryList[i].countryName+'</option>';
                }
                jQuery("#countryId option").remove();
                jQuery("#countryId").append(options);
           }
        });
    }
	
	function changeProduct(){
        var countryId = jQuery("#countryId").val();
        jQuery.ajax({
           type: "POST",
           async:false,
           url: "/product/searchProduct.do",
           data:{countryId:countryId},
           success: function(result){
                var productList=result;
                var options='<option value="" selected="selected">请选择</option>';
                for(var i=0;i<productList.length;i++){
                    options+='<option value='+productList[i].productId+'>'+productList[i].productName+'</option>';
                }
                jQuery("#productId option").remove();
                jQuery("#productId").append(options);
           }
        });
    }
</script>
	<div class="miancon">
		<div class="maincon_title">
			<span class="ico_order_add">+</span><h2>新增订单信息</h2>
			<div class="right"><a class="ico_order_w" title="订单信息管理" href="/lineOrder/list.do?page=1">+</a></div>
		</div>
		<div class="maincon_fluid">
			<form action="/lineOrder/addSubmit.do" method="post" class="form_horizontal hq_form">
		      <div class="widget_box">
		        <div class="widget_title">
		        	<span class="ico_order_r"></span>
		        	<h3>订单基本信息</h3>
		        </div>
		        <div class="widget_content">
		        	<div class="control_group">
		              <label class="control_label"><span class="ico_must">*</span>组团社:</label>
		              <div class="controls">
		               <span class="form_item"><input name="travelAgency" id="travelAgency" type="text" class="text1 js_non_empty" maxlength="50" size="50" placeholder="组团社"></span>
		              </div>
		            </div>	
					
					<div class="control_group">
		              <label class="control_label"><span class="ico_must">*</span>联系人:</label>
		              <div class="controls">
		               <span class="form_item"><input name="contact" id="contact" type="text" class="text1 js_non_empty" maxlength="10" size="10" placeholder="联系人"></span>
		              </div>
		            </div>	
					
					<div class="control_group">
		              <label class="control_label"><span class="ico_must">*</span>联系方式:</label>
		              <div class="controls">
		               <span class="form_item"><input name="contactNo" id="contactNo" type="text" class="text1 js_non_empty" maxlength="50" size="50" placeholder="联系方式"></span>
		              </div>
		            </div>	
					
					<div class="control_group">
		              <label class="control_label"><span class="ico_must">&nbsp;</span>出发日期:</label>
		              <div class="controls">
		               <span class="form_item"><input type="text"  class="text1 js_datepicker" maxlength="10" size="10" placeholder="出发日期" name="startDate" id="startDate" value=""></span>
		              </div>
		            </div> 
					
                    <div class="control_group">
		              <label class="control_label"><span class="ico_must">&nbsp;</span>归国日期:</label>
		              <div class="controls">
		               <span class="form_item"><input type="text"  class="text1 js_datepicker" maxlength="10" size="10" placeholder="归国日期" name="endDate" id="endDate" value=""></span>
		              </div>
		            </div> 
					
					<div class="control_group">
		              <label class="control_label"><span class="ico_must">*</span>行程简介:</label>
		              <div class="controls">
		               <textarea class="text3" id="travelInfo" name="travelInfo" cols="80" rows="5" placeholder="行程简介" maxlength="100"></textarea>
		              </div>
		            </div>	
					
                    <div class="control_group">
                        <label class="control_label"><span class="ico_must">*</span>国家名称:</label>
                        <div class="controls">
                            <span class="form_item"><select name="lineCountryId" id="lineCountryId" class="text2 js_non_empty" placeholder="国家名称">
                                <option value="" selected="selected">请选择</option>
								#foreach($one in $countryList)
									<option value="$one.countryId">$one.countryName</option>
                                #end
                            </select></span>
                        </div>                          
                    </div>
					
					<div class="control_group">
		              <label class="control_label"><span class="ico_must">*</span>客人数量:</label>
		              <div class="controls">
		               <span class="form_item"><input name="nameListSize" id="nameListSize" type="text" class="text1 js_non_empty js_nan" maxlength="8" size="8" placeholder="客人数量"></span>
		              </div>
		            </div>	
					
		        </div>
				
				<div class="widget_title">
		        	<span class="ico_static_r"></span>
		        	<h3>操作信息</h3>
		        </div>
		        <div class="widget_content">
					<div class="control_group">
		              <label class="control_label"><span class="ico_must">*</span>线路操作员:</label>
		              <div class="controls">
		               <span class="form_item"><select name="lineOperatorId" id="lineOperatorId" class="text2 js_non_empty" placeholder="线路操作员">
							<option value="" selected="selected">请选择</option>
							
						</select></span>
		              </div>
		            </div>
					
					<div class="control_group">
		              <label class="control_label"><span class="ico_must">*</span>签证操作员:</label>
		              <div class="controls">
		               <span class="form_item"><select name="visaOperatorId" id="visaOperatorId" class="text2 js_non_empty" placeholder="签证操作员">
							<option value="" selected="selected">请选择</option>
							
						</select></span>
		              </div>
		            </div>  
				</div>
				
		        <div class="widget_title">
		        	<span class="ico_static_r"></span>
		        	<h3>费用计算</h3>
		        </div>
				<div class="widget_content">
		        </div>         
		        <div class="widget_title">
		        	<span class="ico_remark_r"></span>
		        	<h3>备注信息</h3>
		        </div>
		        <div class="widget_content">
		        </div> 
		      </div>
				<div class="form_actions">
					<button type="reset" class="btn btn_reset">重置</button>
	              	<button type="submit" class="btn btn_save">保存</button>
	            </div>			      
		  	</form>
		</div>
	</div>
	<script>
		/*
    	jQuery("#continentId").bind("blur",function(e){
            changeCountry();
        }).bind("change",function(e){
            changeCountry();
        });	
		
		jQuery("#countryId").bind("blur",function(e){
            changeProduct();
        }).bind("change",function(e){
            changeProduct();
        });	
      */  
	</script>
#footer()